var display_name,followers_count,profile_image_url;var screen_name=unescape(gup(document.URL,'user'));var usersURL='http://api.twitter.com/1/users/show/'+screen_name+'.json?callback=showUser';var u=document.createElement('script');u.setAttribute('type','text/javascript');u.setAttribute('src',usersURL);document.getElementsByTagName('head')[0].appendChild(u);var friendsURL='http://api.twitter.com/1/statuses/followers/'+screen_name+'.json?callback=showFans';var f=document.createElement('script');f.setAttribute('type','text/javascript');f.setAttribute('src',friendsURL);document.getElementsByTagName('head')[0].appendChild(f);function showUser(user){display_name=user.name;followers_count=user.followers_count;profile_image_url=user.profile_image_url;}
function updateFans(fans){showFans(fans,1);}
function showFans(fans,update){window.onload=function(){if(update)followers_count++;var fanHTML='<div class="connect_top clearfix"><a href="http://twitter.com/'+screen_name+'" target="_blank"><img src="'+profile_image_url+'" alt="'+display_name+'" class="profileimage"></a><div class="connect_action"><div class="name_block"><a href="http://twitter.com/'+screen_name+'" target="_blank"><span class="name">'+display_name+'</span> on Twitter</a></div><div id ="connectbutton" class="btn-o connect_button profile-user user">';var following=getCookie('f_'+screen_name);if(following){fanHTML+='<span class="is-following"><i></i><strong>Following</strong></span>';}else if(screen_name==getCookie('twitter_screen_name')){fanHTML+='<span class="is-following"><strong>That\'s you!</strong></span>';}else{fanHTML+='<a id="twitter_connect_widget_button" class="btn user" href="#" name="twitter_connect_widget_button"><i></i> <span class="label">Follow</span></a>';}
fanHTML+='</div></div></div><div class="connections">'+display_name+' has <span id="newtotal" class="total total_plus hidden">'+(commaify(followers_count+1))+'</span><span id="oldtotal" class="total">'+commaify(followers_count)+'</span> Followers<div class="connections_grid clearfix" id="fangrid"><div id="newfollower" class="grid_item grid_item_plus hidden"><a href="" target="_blank"></a><div class="name"></div></div>';for(var i=0;i<10;i++){if(fans[i]){fanHTML+='<div id="griditem'+i+'" class="grid_item"><a href="http://twitter.com/'+fans[i].screen_name+'" target="_blank"><img src="'+fans[i].profile_image_url+'" width="48" height="48" /></a><div class="name">'+fans[i].screen_name+'</div></div>';}}
fanHTML+='</div></div>';document.getElementById('fullwidget').innerHTML=fanHTML;if(!following){isFollowing(screen_name);var follow_button=document.getElementById('twitter_connect_widget_button');if(follow_button){if(getCookie('twitter_screen_name')){follow_button.onclick=doFollow;}else{follow_button.onclick=doConnect;}}}}}
function doConnect(){var h=460;var w=800;var top=(screen.height-(h+110))/2;var left=(screen.width-w)/2;var options="height="+h+",width="+w+",left="+left+",screenX="+left+",top="+top+",screenY="+top;var authURL='http://moopz.com/cgi-bin/mtmoopz/mt-comments.cgi?__mode=login_external&blog_id=106&key=Twitter&follow='+screen_name+'&oauth=1&return_to=http://s.moopz.com/fanbox1.html';var winObj=window.open(authURL,'connectWindow',options);}
function doFollow(){var followURL='http://moopz.com/cgi-bin/mtmoopz/mt-comments.cgi?__mode=twitter_follow_jsonp&blog_id=106&follow='+screen_name+'&jsonp=updateFollow';var f=document.createElement('script');f.setAttribute('type','text/javascript');f.setAttribute('src',followURL);document.getElementsByTagName('head')[0].appendChild(f);}
function updateFollow(followed){if(followed){document.getElementById('connectbutton').innerHTML='<span class="is-following"><i></i><strong>Following</strong></span>';document.getElementById('newtotal').className="total";document.getElementById('oldtotal').className="total hidden";var nf_screen_name=getCookie('twitter_screen_name');var nf_profile_image_url=getCookie('commenter_userpic');var g9=document.getElementById('griditem9');if(g9)g9.className="grid_item hidden";document.getElementById('newfollower').innerHTML='<a href="http://twitter.com/'+nf_screen_name+'" target="_blank"><img src="'+nf_profile_image_url+'"></a><div class="name">'+nf_screen_name+'</div>';Â  document.getElementById('newfollower').className="grid_item grid_item_plus";}}
function isFollowing(screen_name){var following=getCookie('f_'+screen_name);if(following)return;var source_screen_name=getCookie('twitter_screen_name');var already_checked=getCookie('n_'+screen_name);if(source_screen_name&&!already_checked){var existsURL='http://api.twitter.com/1/friendships/exists.json?user_a='+source_screen_name+'&user_b='+screen_name+'&callback=updateFollowing';var f=document.createElement('script');f.setAttribute('type','text/javascript');f.setAttribute('src',existsURL);document.getElementsByTagName('head')[0].appendChild(f);}}
function updateFollowing(friends){var now=new Date();fixDate(now);now.setTime(now.getTime()+1*24*60*60*1000);now=now.toGMTString();if(friends){document.getElementById('connectbutton').innerHTML='<span class="is-following"><i></i><strong>Following</strong></span>';setCookie('f_'+screen_name,1,now,'/','.moopz.com','');}else{setCookie('n_'+screen_name,1,now,'/','.moopz.com','');}}
function getCookie(name){var prefix=name+'=';var c=document.cookie;var nullstring='';var cookieStartIndex=c.indexOf(prefix);if(cookieStartIndex==-1)
return nullstring;var cookieEndIndex=c.indexOf(";",cookieStartIndex+prefix.length);if(cookieEndIndex==-1)
cookieEndIndex=c.length;return unescape(c.substring(cookieStartIndex+prefix.length,cookieEndIndex));}
function setCookie(name,value,expires,path,domain,secure){var curCookie=name+"="+escape(value)+(expires?"; expires="+expires:"")+
(path?"; path="+path:"")+(domain?"; domain="+domain:"")+(secure?"secure":"");document.cookie=curCookie;}
function fixDate(date){var base=new Date(0);var skew=base.getTime();if(skew>0)
date.setTime(date.getTime()-skew);}
function commaify(nStr){nStr+='';x=nStr.split('.');x1=x[0];x2=x.length>1?'.'+x[1]:'';var rgx=/(\d+)(\d{3})/;while(rgx.test(x1)){x1=x1.replace(rgx,'$1'+','+'$2');}
return x1+x2;}
function gup(url,name){var regexS="[\\?&]"+name+"=([^&#]*)";var regex=new RegExp(regexS);var tmpURL=url;var results=regex.exec(tmpURL);if(results==null)
return"";else
return results[1];}